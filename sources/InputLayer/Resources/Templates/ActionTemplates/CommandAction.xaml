<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:actions="clr-namespace:InputLayer.Common.Models.Actions;assembly=InputLayer.Common"
                    xmlns:controls="clr-namespace:InputLayer.Controls"
                    xmlns:converters="clr-namespace:InputLayer.Converters"
                    xmlns:me="clr-namespace:InputLayer.MarkupExtensions"
                    xmlns:views="clr-namespace:InputLayer.Views">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Settings/CommandActionSettings.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <DataTemplate DataType="{x:Type actions:CommandAction}">
        <controls:GridWithGap ColumnGap="10" RowGap="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <controls:PlaceholderControl Grid.Row="0"
                                         Grid.Column="0"
                                         IsContentFocused="{Binding ElementName=CommandTextBox,
                                                                    Path=IsFocused}"
                                         IsEmpty="{Binding ElementName=CommandTextBox,
                                                           Path=Text,
                                                           Converter={converters:TextToBooleanConverter}}"
                                         Placeholder="{me:LocalizationBinding Key=InputLayer.CommandAction.Placeholder}">
                <TextBox x:Name="CommandTextBox"
                         VerticalContentAlignment="Center"
                         Text="{Binding Command,
                                        UpdateSourceTrigger=LostFocus}" />
            </controls:PlaceholderControl>

            <controls:StackPanelWithGap Grid.Row="0"
                                        Grid.Column="1"
                                        Gap="10"
                                        Orientation="Horizontal">

                <!--  ReSharper disable Xaml.BindingWithContextNotResolved  -->
                <Button x:Name="ToggleVisibleActionButton"
                        Command="{Binding DataContext.ToggleVisibleActionCommand,
                                          RelativeSource={RelativeSource AncestorType={x:Type views:InputLayerSettingsView}}}"
                        CommandParameter="{Binding}"
                        Cursor="Hand"
                        ToolTip="{me:LocalizationBinding Key=InputLayer.CommandAction.ToggleExecutableVisibility.Description}">
                    <Path Width="16"
                          Height="16"
                          Stretch="Uniform"
                          Stroke="{Binding Path=Foreground,
                                           ElementName=ToggleVisibleActionButton}"
                          StrokeEndLineCap="Round"
                          StrokeLineJoin="Round"
                          StrokeMiterLimit="10"
                          StrokeStartLineCap="Round"
                          StrokeThickness="2">
                        <Path.Data>
                            <MultiBinding Converter="{converters:BooleanToResourceConverter}" Mode="OneWay">
                                <Binding Path="IsHidden" />
                                <Binding Source="NoEyeGeometry" />
                                <Binding Source="EyeGeometry" />
                            </MultiBinding>
                        </Path.Data>
                    </Path>
                </Button>

                <Button x:Name="ToggleOptionalSettingsVisibilityButton"
                        Command="{Binding Path=DataContext.ToggleOptionalSettingsVisibilityCommand,
                                          RelativeSource={RelativeSource AncestorType={x:Type views:InputLayerSettingsView}}}"
                        CommandParameter="{Binding}"
                        Cursor="Hand"
                        ToolTip="{me:LocalizationBinding Key=InputLayer.CommandAction.ToggleOptionalSettingsVisibility.Description}">
                    <Path Width="16"
                          Height="16"
                          Stretch="Uniform"
                          Stroke="{Binding Path=Foreground,
                                           ElementName=ToggleOptionalSettingsVisibilityButton}"
                          StrokeEndLineCap="Round"
                          StrokeLineJoin="Round"
                          StrokeMiterLimit="10"
                          StrokeStartLineCap="Round"
                          StrokeThickness="2">
                        <Path.Data>
                            <MultiBinding Converter="{converters:BooleanToResourceConverter}" Mode="OneWay">
                                <Binding Path="IsOpenOptionalSettings" />
                                <Binding Source="AngleUpGeometry" />
                                <Binding Source="AngleDownGeometry" />
                            </MultiBinding>
                        </Path.Data>
                    </Path>
                </Button>
                <!--  ReSharper restore Xaml.BindingWithContextNotResolved  -->
            </controls:StackPanelWithGap>

            <ContentControl Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Content="{Binding}"
                            ContentTemplate="{StaticResource CommandActionSettings}"
                            Visibility="{Binding IsOpenOptionalSettings,
                                                 Converter={converters:BooleanToVisibilityConverter}}" />
        </controls:GridWithGap>
    </DataTemplate>

</ResourceDictionary>