<UserControl x:Class="InputLayer.Views.ActionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:actions="clr-namespace:InputLayer.Common.Models.Actions;assembly=InputLayer.Common"
             xmlns:attachedProperties="clr-namespace:InputLayer.AttachedProperties"
             xmlns:controls="clr-namespace:InputLayer.Controls"
             xmlns:converters="clr-namespace:InputLayer.Converters"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:infrastructuresCommon="clr-namespace:InputLayer.Common.Infrastructures;assembly=InputLayer.Common"
             xmlns:local="clr-namespace:InputLayer.Views"
             xmlns:markupExtensions="clr-namespace:InputLayer.MarkupExtensions"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DataContext="{d:DesignInstance actions:IAction}"
             d:DesignHeight="450"
             d:DesignWidth="800"
             mc:Ignorable="d">
    <UserControl.Resources>
        <Geometry x:Key="EyeGeometry">
            F1 M24,24z M0,0z M12.0002,19C10.5869,19 9.1973,18.7095 7.8702,18.1366 5.2376,17 3.0992,14.77 2.0035,12.0184 1.9988,12.0066 1.9988,11.9935 2.0035,11.9817 3.1099,9.202 5.1825,7.0339 7.8395,5.877 9.1755,5.295 10.5752,5 11.9997,5 13.413,5 14.8026,5.2906 16.1298,5.8635 18.7624,7.0001 20.9008,9.2301 21.9965,11.9817 22.0012,11.9935 22.0012,12.0066 21.9965,12.0184 20.8901,14.7981 18.8175,16.9662 16.1605,18.1232 14.8245,18.705 13.4248,19 12.0002,19z M12,15.028C10.3266,15.028 8.9652,13.6697 8.9652,12 8.9652,10.3303 10.3266,8.972 12,8.972 13.6734,8.972 15.0348,10.3303 15.0348,12 15.0348,13.6697 13.6734,15.028 12,15.028z
        </Geometry>
        <Geometry x:Key="NoEyeGeometry">
            F1 M24,24z M0,0z M9.8324,5.2324C10.5448,5.0782 11.2689,5 11.9997,5 13.413,5 14.8026,5.2906 16.1298,5.8635 18.7624,7.0001 20.9008,9.2301 21.9965,11.9817 22.0012,11.9935 22.0012,12.0066 21.9965,12.0184 21.4998,13.2664 20.8077,14.3906 19.956,15.3559 M6.5473,6.5473C4.5113,7.7832 2.9233,9.6707 2.0035,11.9816 1.9988,11.9935 1.9988,12.0066 2.0035,12.0183 3.0992,14.77 5.2376,17 7.8703,18.1366 9.1974,18.7095 10.5869,19 12.0003,19 13.4249,19 14.8246,18.705 16.1605,18.1233 16.6087,17.9281 17.0397,17.7036 17.4528,17.4528 M21,21L3.05,3.05 M9.6656,10.0671C9.2284,10.5919 8.9652,11.2658 8.9652,12 8.9652,13.6697 10.3266,15.028 12,15.028 12.7357,15.028 13.4112,14.7654 13.9371,14.3293
        </Geometry>

        <GeometryGroup x:Key="OpenGeometry">
            <Geometry>F1 M32,32z M0,0z M1.954,31.999L1.954,31.999 0,31.934 0,6 11.414,6 15.316,10 28,10 28,17 26,17 26,12 14.473,12 10.571,8 2,8 2,30 2.022,30.001 2,30.644 2,30.967 1.989,30.967z</Geometry>
            <Geometry>F1 M32,32z M0,0z M28.82,32L0.754,32 4.297,16 32.02,16 28.82,32z M3.246,30L27.18,30 29.58,18 5.903,18 3.246,30z</Geometry>
            <Geometry>F1 M32,32z M0,0z M30.299,7.713L27.827,5.285C26.345,3.803 24.384,2.99 22.3,2.99 20.216,2.99 18.255,3.803 16.779,5.279L15.365,3.865C19.189,0.0410000000000004,25.412,0.0410000000000004,29.236,3.865L31.701,6.287 30.299,7.713z</Geometry>
            <Geometry>F1 M32,32z M0,0z M32,8L32,8 24,8 24,6 30,6 30,0 32,0z</Geometry>
        </GeometryGroup>
    </UserControl.Resources>

    <ContentControl Content="{Binding}">
        <ContentControl.Resources>
            <DataTemplate DataType="{x:Type actions:CommandAction}">
                <controls:GridWithGap ColumnGap="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="CommandTextBox"
                             Grid.Column="0"
                             VerticalContentAlignment="Center"
                             Text="{Binding Command, UpdateSourceTrigger=LostFocus}" />

                    <TextBlock Grid.Column="0"
                               Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=CommandTextBox}"
                               FontSize="{Binding FontSize, ElementName=CommandTextBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=CommandTextBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerCommandActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="CommandTextBox" Path="Text" />
                                <Binding ElementName="CommandTextBox" Path="IsFocused" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>

                    <!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
                    <Button x:Name="ToggleVisibleActionButton"
                            Grid.Column="1"
                            Command="{Binding DataContext.ToggleVisibleActionCommand, RelativeSource={RelativeSource AncestorType={x:Type local:InputLayerSettingsView}}}"
                            CommandParameter="{Binding}"
                            Cursor="Hand"
                            ToolTip="{DynamicResource LOCInputLayerExecutableToggleVisibilityDescription}">
                        <Path Width="16"
                              Height="16"
                              Stretch="Uniform"
                              Stroke="{Binding Foreground, ElementName=ToggleVisibleActionButton}"
                              StrokeEndLineCap="Round"
                              StrokeLineJoin="Round"
                              StrokeMiterLimit="10"
                              StrokeStartLineCap="Round"
                              StrokeThickness="2">
                            <Path.Data>
                                <MultiBinding Converter="{converters:BooleanToGeometryConverter}" Mode="OneWay">
                                    <Binding Path="IsHidden" />
                                    <Binding Source="{StaticResource NoEyeGeometry}" />
                                    <Binding Source="{StaticResource EyeGeometry}" />
                                </MultiBinding>
                            </Path.Data>
                        </Path>
                    </Button>
                    <!-- ReSharper restore Xaml.BindingWithContextNotResolved -->
                </controls:GridWithGap>
            </DataTemplate>

            <DataTemplate DataType="{x:Type actions:PowerShellCommandAction}">
                <controls:GridWithGap ColumnGap="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="PowerShellCommandTextBox"
                             Grid.Column="0"
                             VerticalContentAlignment="Center"
                             Text="{Binding Command, UpdateSourceTrigger=LostFocus}" />

                    <TextBlock Grid.Column="0"
                               Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=PowerShellCommandTextBox}"
                               FontSize="{Binding FontSize, ElementName=PowerShellCommandTextBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=PowerShellCommandTextBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerPowerShellCommandActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="PowerShellCommandTextBox" Path="Text" />
                                <Binding ElementName="PowerShellCommandTextBox" Path="IsFocused" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>

                    <!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
                    <Button x:Name="ToggleVisibleActionButton"
                            Grid.Column="1"
                            Command="{Binding DataContext.ToggleVisibleActionCommand, RelativeSource={RelativeSource AncestorType={x:Type local:InputLayerSettingsView}}}"
                            CommandParameter="{Binding}"
                            Cursor="Hand"
                            ToolTip="{DynamicResource LOCInputLayerExecutableToggleVisibilityDescription}">
                        <Path Width="16"
                              Height="16"
                              Stretch="Uniform"
                              Stroke="{Binding Foreground, ElementName=ToggleVisibleActionButton}"
                              StrokeEndLineCap="Round"
                              StrokeLineJoin="Round"
                              StrokeMiterLimit="10"
                              StrokeStartLineCap="Round"
                              StrokeThickness="2">
                            <Path.Data>
                                <MultiBinding Converter="{converters:BooleanToGeometryConverter}" Mode="OneWay">
                                    <Binding Path="IsHidden" />
                                    <Binding Source="{StaticResource NoEyeGeometry}" />
                                    <Binding Source="{StaticResource EyeGeometry}" />
                                </MultiBinding>
                            </Path.Data>
                        </Path>
                    </Button>
                    <!-- ReSharper restore Xaml.BindingWithContextNotResolved -->
                </controls:GridWithGap>
            </DataTemplate>

            <DataTemplate DataType="{x:Type actions:ExecutableAction}">
                <controls:GridWithGap ColumnGap="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBox x:Name="ExecutableTextBox"
                             Grid.Column="0"
                             VerticalContentAlignment="Center"
                             Focusable="False"
                             HorizontalScrollBarVisibility="Hidden"
                             IsReadOnly="True"
                             Text="{Binding FileName, UpdateSourceTrigger=PropertyChanged, Converter={converters:PathToFileNameConverter}}" />

                    <TextBlock Grid.Column="0"
                               Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=ExecutableTextBox}"
                               FontSize="{Binding FontSize, ElementName=ExecutableTextBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=ExecutableTextBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerExecutableActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="ExecutableTextBox" Path="Text" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>

                    <!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
                    <Button x:Name="ToggleVisibleActionButton"
                            Grid.Column="1"
                            Command="{Binding DataContext.ToggleVisibleActionCommand, RelativeSource={RelativeSource AncestorType={x:Type local:InputLayerSettingsView}}}"
                            CommandParameter="{Binding}"
                            Cursor="Hand"
                            ToolTip="{DynamicResource LOCInputLayerExecutableToggleVisibilityDescription}">
                        <Path Width="16"
                              Height="16"
                              Stretch="Uniform"
                              Stroke="{Binding Foreground, ElementName=ToggleVisibleActionButton}"
                              StrokeEndLineCap="Round"
                              StrokeLineJoin="Round"
                              StrokeMiterLimit="10"
                              StrokeStartLineCap="Round"
                              StrokeThickness="2">
                            <Path.Data>
                                <MultiBinding Converter="{converters:BooleanToGeometryConverter}" Mode="OneWay">
                                    <Binding Path="IsHidden" />
                                    <Binding Source="{StaticResource NoEyeGeometry}" />
                                    <Binding Source="{StaticResource EyeGeometry}" />
                                </MultiBinding>
                            </Path.Data>
                        </Path>
                    </Button>

                    <Button Grid.Column="2"
                            Command="{Binding DataContext.OpenExecutableCommand, RelativeSource={RelativeSource AncestorType={x:Type local:InputLayerSettingsView}}}"
                            CommandParameter="{Binding Path=., Mode=TwoWay}"
                            ToolTip="{DynamicResource LOCInputLayerExecutableActionSelect}">
                        <Path Width="16"
                              Height="16"
                              Data="{StaticResource OpenGeometry}"
                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"
                              Stretch="Uniform" />
                    </Button>
                    <!-- ReSharper restore Xaml.BindingWithContextNotResolved -->

                </controls:GridWithGap>
            </DataTemplate>

            <DataTemplate DataType="{x:Type actions:KeyboardAction}">
                <Grid>
                    <TextBox x:Name="KeyboardTextBox"
                             VerticalContentAlignment="Center"
                             attachedProperties:HotKeyTextBoxBehavior.IsEnabled="True"
                             IsReadOnly="True">
                        <TextBox.Text>
                            <MultiBinding Converter="{converters:KeyboardActionToTextConverter}"
                                          Mode="OneWay"
                                          UpdateSourceTrigger="Explicit">
                                <Binding Path="Modifiers" />
                                <Binding Path="Key" />
                            </MultiBinding>
                        </TextBox.Text>
                    </TextBox>

                    <TextBlock Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=KeyboardTextBox}"
                               FontSize="{Binding FontSize, ElementName=KeyboardTextBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=KeyboardTextBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerKeyboardActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="KeyboardTextBox" Path="Text" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>
                </Grid>
            </DataTemplate>

            <DataTemplate DataType="{x:Type actions:PlayniteAction}">
                <Grid>
                    <ComboBox x:Name="PlayniteActionComboBox"
                              ItemsSource="{Binding Source={x:Type infrastructuresCommon:PlayniteActionType}, Converter={converters:EnumToSourceConverter}}"
                              SelectedValue="{Binding ActionType, Mode=TwoWay}">

                        <ComboBox.ItemTemplate>
                            <DataTemplate DataType="{x:Type infrastructuresCommon:PlayniteActionType}">
                                <TextBlock Text="{markupExtensions:LocalizationBinding Path=., StringFormat={}LOCInputLayer{0}PlayniteAction}" ToolTip="{markupExtensions:LocalizationBinding Path=., StringFormat={}LOCInputLayer{0}PlayniteActionDescription}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>

                    </ComboBox>

                    <TextBlock Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=PlayniteActionComboBox}"
                               FontSize="{Binding FontSize, ElementName=PlayniteActionComboBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=PlayniteActionComboBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerKeyboardActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="PlayniteActionComboBox" Path="SelectedValue" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>
                </Grid>
            </DataTemplate>

            <DataTemplate DataType="{x:Type actions:ControllerAction}">
                <Grid>
                    <ComboBox x:Name="ControllerActionComboBox"
                              ItemsSource="{Binding Source={x:Type infrastructuresCommon:ControllerActionType}, Converter={converters:EnumToSourceConverter}}"
                              SelectedValue="{Binding ActionType, Mode=TwoWay}">

                        <ComboBox.ItemTemplate>
                            <DataTemplate DataType="{x:Type infrastructuresCommon:ControllerActionType}">
                                <TextBlock Text="{markupExtensions:LocalizationBinding Path=., StringFormat={}LOCInputLayer{0}ControllerAction}" ToolTip="{markupExtensions:LocalizationBinding Path=., StringFormat={}LOCInputLayer{0}ControllerActionDescription}" />
                            </DataTemplate>
                        </ComboBox.ItemTemplate>

                    </ComboBox>

                    <TextBlock Margin="6,6,0,0"
                               Focusable="False"
                               FontFamily="{Binding FontFamily, ElementName=ControllerActionComboBox}"
                               FontSize="{Binding FontSize, ElementName=ControllerActionComboBox}"
                               FontStyle="Italic"
                               Foreground="{Binding Foreground, ElementName=ControllerActionComboBox}"
                               IsHitTestVisible="False"
                               Opacity="0.3"
                               Text="{DynamicResource LOCInputLayerKeyboardActionPlaceholder}">
                        <TextBlock.Visibility>
                            <MultiBinding Converter="{converters:PlaceholderVisibilityConverter}">
                                <Binding ElementName="ControllerActionComboBox" Path="SelectedValue" />
                            </MultiBinding>
                        </TextBlock.Visibility>
                    </TextBlock>
                </Grid>
            </DataTemplate>
        </ContentControl.Resources>
    </ContentControl>
</UserControl>